# Манипулирование изображениями

## SYNOPSYS
```C
void    *mlx_new_image ( void *mlx_ptr, int width, int height );

char    *mlx_get_data_addr ( void *img_ptr, int *bits_per_pixel, int *size_line, int *endian );

int     mlx_put_image_to_window ( void *mlx_ptr, void *win_ptr, void *img_ptr, int x, int y );

unsigned int    mlx_get_color_value ( void *mlx_ptr, int color );

void    *mlx_xpm_to_image ( void *mlx_ptr, char **xpm_data, int *width, int *height );

void    *mlx_xpm_file_to_image ( void *mlx_ptr, char *filename, int *width, int *height );

int     mlx_destroy_image ( void *mlx_ptr, void *img_ptr );
```

## ОПИСАНИЕ

Функция `mlx_new_image()` создает в памяти новый образ. Она возвращает идентификатор `void *`, необходимый для последующего манипулирования этим изображением.  
Функции нужен только размер создаваемого изображения с использованием параметров `width` и` height`, а также идентификатора соединения `mlx_ptr` (см. [Руководства по mlx](man_mlx.md)).

Пользователь может рисовать внутри изображения ([увидеть ниже](#сохранение-цветных-изображений-внутри)), и может выгрузить изображение в указанное окно в любое время, чтобы отобразить его на экране. Это делается с помощью функции `mlx_put_image_to_window()`. Здесь необходимы три идентификатора для подключения к дисплею, используемого окна и изображения (соответственно `mlx_ptr` , `win_ptr` и `img_ptr` ).
Координаты `(x, y)` определяют, где изображение должно быть помещено в окне.

Функция `mlx_get_data_addr()` возвращает информацию о созданном изображении, позволяя пользователю изменить его позже.  Параметр `img_ptr` указывает изображение для использования. Следующие три параметра должны быть адресами трех разных действительных целых чисел:

* `bits_per_pixel` будет заполнено числом битов, необходимых для представления цвета пикселя (также называемого глубиной изображения).
* `size_line` - это количество байтов, используемых для хранения одной строки изображения в памяти. Эта информация нужна для перехода от одной строки к другой на изображении.
* `endian` сообщает вам, должен ли цвет пикселя изображения храниться как маленький (endian == 0) или большой (endian == 1).

Функция `mlx_get_data_addr` возвращает адрес `char *`, который представляет начало области памяти, в которой изображение сохраняется.  
Из этого адреса первые биты `bits_per_pixel` представляют цвет первого пикселя в первой строке изображения.  
Вторая группа битов `bits_per_pixel` представляет второй пиксель первой строки и так далее.  

Добавьте к адресу `size_line`, чтобы получить начало второй строки. Таким образом можно добраться до любых пикселей изображения.

Функция `mlx_destroy_image` уничтожает данное изображение (`img_ptr`).

## СОХРАНЕНИЕ ЦВЕТНЫХ ИЗОБРАЖЕНИЙ ВНУТРИ

В зависимости от дисплея количество битов, используемых для хранения цвета пикселя, может меняться.

Пользователь обычно представляет цвет в режиме `RGB`, используя по одному байту для каждого компонента. (см. [Страницу руководства по mlx](man_mlx.md)).


Это должно быть преобразовано, чтобы соответствовать требованию `bit_per_pixel` изображения и сделать цвет понятным для графической системы.  
В этом и заключается цель функции `mlx_get_color_value()`.
Он принимает стандартный параметр цвета `RGB` и возвращает значение типа `int` без знака.


Младшие значащие биты `bits_per_pixel` этого значения могут храниться в изображении.

Имейте в виду, что позиция младших битов зависит от порядка байтов на локальном компьютере.

Если порядок байтов изображения (фактически, порядок порядков байтов на компьютере `X-Servers` для удаленного отображения `X11`) отличается от локального порядка байтов, то значение должно быть преобразовано перед использованием.

## ИЗОБРАЖЕНИЯ XPM

Функции `mlx_xpm_to_image()` и `mlx_xpm_file_to_image()` будут создавать новое изображение таким же образом.
Они будут заполнять его, используя указанные `xpm_data` или` filename`, в зависимости от того, какая функция используется.
Обратите внимание, что `MiniLibX` не использует стандартную библиотеку `Xpm` для работы с изображениями `xpm`. Возможно, вы не сможете читать все типы изображений `xpm`. Однако он обрабатывает прозрачность.
       
## ВОЗВРАЩАЕМЫЕ ЗНАЧЕНИЯ

Три функции, которые создают изображения, `mlx_new_image()`, `mlx_xpm_to_image()` и `mlx_xpm_file_to_image()`, вернут нулевой указатель (`NULL`) в случае возникновения ошибки. В противном случае они возвращают ненулевой указатель в качестве идентификатора изображения.

## СМОТРИТЕ ТАКЖЕ
 [Руководство по использованию изображений в minilibX](how_use_images_in_mimilibx.md)
 
| [mlx(3)](man_mlx.md) | [mlx_new_window(3)](man_mlx_new_window.md) | [mlx_pixel_put(3)](man_mlx_pixel_put.md) | [mlx_loop(3)](man_mlx_loop.md) |
